<tbody>
  <% dependencies.user.forEach(user => { %>
    <tr>
      <td><%= user.username %></td>
      <% 
        let totalHeures = 0; // compteur pour chaque utilisateur
      %>
      <% for (let y = startYear; y <= endYear; y++) { %>
        <% 
          let moisDebut = (y === startYear) ? startMonth : 1;
          let moisFin   = (y === endYear)   ? endMonth   : 12;
        %>
        <% for (let m = moisDebut; m <= moisFin; m++) { 
             let pointPourMois = null;
             dependencies.pointage.forEach(point => {
               let d = new Date(point.date);
               if (point.users_id === user.id && d.getMonth() + 1 === parseInt(m) && d.getFullYear() === parseInt(y)) {
                 pointPourMois = point;
               }
             });
        %>
          <td>
            <% if (pointPourMois) { %>
              <%= pointPourMois.heure %>
              <% totalHeures += pointPourMois.heure; %>
            <% } else { %>
              -
            <% } %>
          </td>
        <% } %>
      <% } %>
      <td><strong><%= totalHeures %></strong></td>
      <td>
        <a href="/user/<%= user.id %>?lotpi=<%= lotpi.id %>&year=<%= year %>" class="btn btn-sm btn-primary">Voir</a>
      </td>
    </tr>
  <% }) %>
</tbody>
